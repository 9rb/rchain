//scalapackage coop.rchain.rholang.collection

new
  rl(`rho:registry:lookup`), RhoSpecCh,
  stdlog(`rho:io:stdlog`), stdout(`rho:io:stdout`),
  setup, test1, test_flatmap, test_compose,
  RevVault
in {
  rl!(`rho:id:6wnujzcraztjfg941skrtbdkdgbko8nuaqihuhn15s66oz8ro5gwbb`, *RhoSpecCh) |
  for(@(_, RhoSpec) <- RhoSpecCh) {
    @RhoSpec!("testSuite", *setup,
      [
        ("test1", *test1),
      ])
  } |

  contract setup(ret) = {
    new RevVaultCh in {
      rl!(`rho:id:1o93uitkrjfubh43jt19owanuezhntag5wh74c6ur5feuotpi73q8z`, *RevVaultCh) |
      for (@(_, RevVault) <- RevVaultCh) {
        ret!(RevVault)
      }
    }
  } |

  contract test1(rhoSpec, RevVault, ackCh) = {
    new r1 in {
      RevVault!(*r1) |
      rhoSpec!("assertMany",
        [
          (("Hello!", "== <-", *r1), "greeeting"),
        ], *ackCh
      )
    }
  }
}
